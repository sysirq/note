# 环境

FGT_VM64_KVM-v6-build0335-FORTINET.out.kvm.zip

cb609d431404bbf2a782c82cd317a2de43767c52c414b2f3f87e76e166393c61

# rootfs解压

未发现对rootfs在内核中做解压解密操作，正常gz文件

# 完整性检查

### 内核完整性检查

未发现

### 用户态完整性检查

未发现

# sbin/init

```c
__int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  char *argv[2]; // [rsp+0h] [rbp-10h] BYREF

  sub_4013B0();//会读取/目录下的所有的文件的内容，计算sha256，然后保存在/.fgtsum中
  if ( (int)sub_401610("bin") >= 0 && (int)sub_401610("migadmin") >= 0 )
    sub_401610("usr");
  unlink("/sbin/xz");
  unlink("/sbin/ftar");
  argv[0] = "/bin/init";
  argv[1] = 0LL;
  execve("/bin/init", argv, 0LL);
  return 0LL;
}
```

