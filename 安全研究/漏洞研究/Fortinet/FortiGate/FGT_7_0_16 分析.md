# 信息收集

### apache 版本

```
Apache/2.4.52 (Unix)
```

### openssl 版本

```
/ # busybox strings  /lib/libssl.so.1.1  | busybox grep Open
OpenSSL 1.1.1u  30 May 2023
```

### jemalloc版本

```
/ # busybox strings /lib/libjemalloc.so.2  | grep 5
5.2.1-0-gea6b3e973b477b8061e0076bb257dbd7f3faa756
```

### sslvpn 代码信息

```
.rodata:0000000002FC9C80	00000027	C	/code/daemon/sslvpnd/http/apache_ssl.c
.rodata:0000000002FCABB0	00000026	C	/code/daemon/sslvpnd/http/http_core.c
.rodata:0000000002FCD338	00000025	C	/code/daemon/sslvpnd/modules/error.c
.rodata:0000000002FCED90	0000002C	C	/code/daemon/sslvpnd/modules/logindisable.c
.rodata:0000000002FCEEA8	00000027	C	/code/daemon/sslvpnd/modules/message.c
.rodata:0000000002FCEED0	00000027	C	/code/daemon/sslvpnd/modules/mod_dir.c
.rodata:0000000002FCEF88	00000029	C	/code/daemon/sslvpnd/modules/mod_image.c
.rodata:0000000002FCEFB8	00000028	C	/code/daemon/sslvpnd/modules/mod_mime.c
.rodata:0000000002FCF2A8	00000029	C	/code/daemon/sslvpnd/modules/mod_proxy.c
.rodata:0000000002FCF2D8	0000002F	C	/code/daemon/sslvpnd/modules/mod_zip_archive.c
.rodata:0000000002FD3EB0	00000029	C	/code/daemon/sslvpnd/modules/rmt_login.c
.rodata:0000000002FDE538	0000002A	C	/code/daemon/sslvpnd/modules/rmt_tunnel.c
.rodata:0000000002FDE608	0000002B	C	/code/daemon/sslvpnd/modules/rmt_tunnel2.c
.rodata:0000000002FDE638	0000002A	C	/code/daemon/sslvpnd/modules/rmt_webcgi.c
.rodata:0000000002FDFD28	00000028	C	/code/daemon/sslvpnd/proxy/proxy_html.c
.rodata:0000000002FE30A0	00000028	C	/code/daemon/sslvpnd/state/http_state.c
.rodata:0000000002FE5AC0	0000002B	C	/code/daemon/sslvpnd/libtelnet/libtelnet.c
```

```
module addr:  0x41d6660
name:  /code/daemon/sslvpnd/http/apache_ssl.c
module addr:  0x41d67a0
name:  /code/daemon/sslvpnd/http/http_core.c
module addr:  0x41d7320
name:  /code/daemon/sslvpnd/modules/error.c
module addr:  0x41d7480
name:  /code/daemon/sslvpnd/modules/logindisable.c
module addr:  0x41d7580
name:  /code/daemon/sslvpnd/modules/message.c
module addr:  0x41d7660
name:  /code/daemon/sslvpnd/modules/mod_dir.c
module addr:  0x41d7760
name:  /code/daemon/sslvpnd/modules/mod_image.c
module addr:  0x41d7860
name:  /code/daemon/sslvpnd/modules/mod_mime.c
module addr:  0x41d7980
name:  /code/daemon/sslvpnd/modules/mod_proxy.c
module addr:  0x41d7a60
name:  /code/daemon/sslvpnd/modules/mod_zip_archive.c
module addr:  0x41d81c0
name:  /code/daemon/sslvpnd/modules/rmt_tunnel.c
module addr:  0x41d82c0
name:  /code/daemon/sslvpnd/modules/rmt_tunnel2.c
module addr:  0x41d83c0
name:  /code/daemon/sslvpnd/modules/rmt_webcgi.c
```

# 事件循环机制

# log区

- 

```
[220:root:b]SSL established: TLSv1.3 TLS_AES_256_GCM_SHA384
[220:root:b]req: /sslvpn/js/login.js?q=d7e0e2cb7ea9e4b9c6
[220:root:b]mza: 0x2f83bd0 /sslvpn/js/login.js
[220:root:b]sslConnGotoNextState:309 error (last state: 1, closeOp: 0)
[220:root:b]Destroy sconn 0x7f00ac163100, connSize=0. (root)
[220:root:b]SSL state:warning close notify (192.168.182.135)
```

- 

```
[221:root:b]SSL established: TLSv1.3 TLS_AES_256_GCM_SHA384
[221:root:b]req: /remote/fgt_lang?lang=en
[221:root:b]sslConnGotoNextState:309 error (last state: 1, closeOp: 0)
[221:root:b]Destroy sconn 0x7f00ac163100, connSize=0. (root)
[221:root:b]SSL state:warning close notify (192.168.182.135)
```

- 

```
[219:root:10]SSL established: TLSv1.3 TLS_AES_256_GCM_SHA384
[219:root:10]req: /remote/login?&err=sslvpn_login_permissi
[219:root:10]rmt_web_auth_info_parser_common:492 no session id in auth info
[219:root:10]rmt_web_get_access_cache:841 invalid cache, ret=4103
[219:root:10]User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36
[219:root:10]get_cust_page:128 saml_info 0
[219:root:10]sslConnGotoNextState:309 error (last state: 1, closeOp: 0)
[219:root:10]Destroy sconn 0x7f00ac162a00, connSize=0. (root)
[219:root:10]SSL state:warning close notify (192.168.182.135)
```

- 

```
[220:root:10]SSL established: TLSv1.3 TLS_AES_256_GCM_SHA384
[220:root:10]req: /remote/logincheck
[220:root:10]rmt_web_auth_info_parser_common:492 no session id in auth info
[220:root:10]rmt_web_access_check:760 access failed, uri=[/remote/logincheck],ret=4103,
[220:root:10]User Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36
[220:root:10]sslvpn_auth_check_usrgroup:2978 forming user/group list from policy.
[220:root:10]sslvpn_auth_check_usrgroup:3024 got user (0) group (1:0).
[220:root:10]sslvpn_validate_user_group_list:1890 validating with SSL VPN authentication rules (0), realm ().
[220:root:10]sslvpn_validate_user_group_list:2876 got user (0:0), group (1:0) peer group (0).
[220:root:10]sslvpn_update_user_group_list:1793 got user (0:0), group (1:0), peer group (0) after update.
[220:root:10]two factor check for admin: off
[220:root:10]sslvpn_authenticate_user:183 authenticate user: [admin]
[220:root:10]sslvpn_authenticate_user:197 create fam state
[220:root:10][fam_auth_send_req_internal:426] Groups sent to FNBAM:
[220:root:10]group_desc[0].grpname = sslvpngroup 
[220:root:10][fam_auth_send_req_internal:438] FNBAM opt = 0X200401
[220:root:10]fam_auth_send_req_internal:514 fnbam_auth return: 1
[220:root:10][fam_auth_send_req_internal:539] Authenticated groups (1) by FNBAM with auth_type (1):
[220:root:10]Received: auth_rsp_data.grp_list[0] = 0 
[220:root:10]fam_auth_send_req:1007 task finished with 1
[220:root:10]login_failed:392 user[admin],auth_type=1 failed [sslvpn_login_permission_denied]
[220:root:0]dump_one_blocklist:94 status=1;host=192.168.182.135;fails=1;logintime=1740037414
[220:root:10]sslConnGotoNextState:309 error (last state: 1, closeOp: 0)
[220:root:10]Destroy sconn 0x7f00ac162a00, connSize=0. (root)
[220:root:10]SSL state:warning close notify (192.168.182.135)
```
