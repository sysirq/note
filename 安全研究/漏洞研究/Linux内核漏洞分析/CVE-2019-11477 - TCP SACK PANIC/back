#!/usr/bin/python3

from scapy.all import *

target_ip = '192.168.222.129'
target_port = 2333
target_seq = 0
my_port = 0
my_seq = 0

# build connection

ans = sr1(IP(dst=target_ip)/TCP(dport=target_port,sport=RandShort(),seq=RandInt(),flags='S',options=[('MSS',48),('SAckOK', '')],window=8),verbose=False) # syn

print("MSS: 48")

my_port = ans[TCP].dport
my_seq = ans[TCP].ack     
target_seq = ans[TCP].seq + 1


sr1(IP(dst=target_ip)/TCP(dport=target_port,sport=my_port,ack=target_seq,seq=my_seq,flags='A',options=[('MSS',48),('SAckOK', '')],window=8),verbose=False) # ack
