# Zergeca

参考资料：https://blog.xlab.qianxin.com/the-swarm-awakens-a-deep-dive-into-the-zergeca-botnet-cn/

- 支持多种DNS解析方式，优先使用DOH（DNS over HTTPS）进行C2解析
- 使用不常见的Smux库实现C2通信协议，并通过xor进行加密

### 持久化

在被侵入的设备中增加系统服务geomi.service实现持久化，当设备重启或进程被结束时，自动生成geomi新进程。

```
[Unit]
Description=
Requires=network.target
After=network.target
[Service]
PIDFile=/run/geomi.pid
ExecStartPre=/bin/rm -f /run/geomi.pid
ExecStart=/usr/bin/geomi
Restart=always
[Install]
WantedBy=multi-user.target
```

### 删除

- 1.删除/etc/systemd/system/geomi.service
- 2.删除ExecStart参数指向样本文件
- 3.结束geomi进程

### 对抗

Zergeca会对系统实时监控，当系统中的进程名，运行时参数命中了名单中的字串，则直接结束进程，并删除对应的二进制文件。

```
OZI.A	COM.UFO.MINER	KINSING	KTHREADDI
kaiten	srv00	meminitsrv	.javae
solr.sh	monerohash	minexmr	c3pool
crypto-pool.fr	f2pool.com	xmrpool.eu	.........
```

### 敏感信息上报

Zergeca定义了一个名为DeviceInfo的结构体用于存储设备的敏感信息，涵盖"国家，公网IP，操作系统，用户组，运行目录，是否可达"等。

```
struct DeviceInfo
{
Country string
PlucAddress byte[]
MAC string
OS string
ARCH string
Name string
MachineId string
Numcpu uint32
CPUMODEL string
username string
uid string
gid string
Users []string
Uptime time.Duration
PID	uitn32
Path string
checksum []uint8
version string
Reachable bool
}
```

# Vo1d

资料：https://blog.xlab.qianxin.com/long_live_the_botnet_vo1d_is_back_cn/

- 1.通信加密增强：网络通信使用 RSA 加密，提高数据传输的隐匿性，同时**保证即使DGA C2被安全研究人员注册，也不可能接管网络**。
- 2.基本设施结构升级：引入了硬编码，域名生成算法（DGA）俩种形式的Redirector C2用以保护真实C2，极大增强僵尸网络的隐蔽性、灵活性和抗打击能力。
- Payload 投递策略优化：每个 Payload 都配备了独立的 Downloader，其中 Payload 本身使用魔改后的 XXTEA 算法加密，其加密密钥通过 RSA 进行保护，大幅提升了对抗分析能力。